<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Webdriver Torso — Aqua</title>
  <style>
    body {
      margin: 0;
      background: #fff;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <script>
    (function WebdriverTorso() {
      const CANVAS_ID = "wdt-canvas";
      const FONT_FAMILY = "Courier New, monospace"; // Courier New Bold
      const BEEP_DURATION = 1.0; // 1 second
      const BEEP_VOLUME = 0.2;

      // create canvas
      let canvas = document.getElementById(CANVAS_ID);
      if (!canvas) {
        canvas = document.createElement("canvas");
        canvas.id = CANVAS_ID;
        document.body.appendChild(canvas);
      }
      const ctx = canvas.getContext("2d");

      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();

      // audio
      const AudioCtx = window.AudioContext || window.webkitAudioContext;
      let audioCtx = new AudioCtx();

      function playBeep() {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        // random freq 512–1083 Hz
        const freq = 512 + Math.random() * (1083 - 512);
        osc.type = "sine";
        osc.frequency.value = freq;

        gain.gain.value = BEEP_VOLUME;
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        osc.start();
        osc.stop(audioCtx.currentTime + BEEP_DURATION);
      }

      // slide counter
      let slideIndex = 0;
      function filename(idx) {
        return `aqua.flv - Slide ${String(idx).padStart(4, "0")}`;
      }

      // draw slide (red left, blue right)
      function drawSlide(idx) {
        const w = canvas.width;
        const h = canvas.height;
        ctx.fillStyle = "#fff";
        ctx.fillRect(0, 0, w, h);

        // red rectangle (left side)
        const rectW1 = Math.random() * (w / 2.5);
        const rectH1 = Math.random() * (h / 2);
        const rectX1 = w * 0.1;
        const rectY1 = Math.random() * (h - rectH1);

        // blue rectangle (right side)
        const rectW2 = Math.random() * (w / 2.5);
        const rectH2 = Math.random() * (h / 2);
        const rectX2 = w * 0.6;
        const rectY2 = Math.random() * (h - rectH2);

        ctx.fillStyle = "red";
        ctx.fillRect(rectX1, rectY1, rectW1, rectH1);
        ctx.fillStyle = "blue";
        ctx.fillRect(rectX2, rectY2, rectW2, rectH2);

        // filename text
        ctx.font = `bold ${Math.floor(h * 0.03)}px ${FONT_FAMILY}`;
        ctx.fillStyle = "#000";
        ctx.textBaseline = "bottom";
        ctx.fillText(filename(idx), 20, h - 20);
      }

      // loop: draw → beep → wait 1s → next
      function nextSlide() {
        drawSlide(slideIndex);
        playBeep();
        slideIndex++;
        setTimeout(nextSlide, BEEP_DURATION * 1000);
      }

      // start
      nextSlide();
    })();
  </script>
</body>
</html>
